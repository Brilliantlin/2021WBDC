# 2021微信大数据挑战赛-微信视频号推荐复盘

成绩：第一次接触推荐类的任务，最终55名没拿到奖金，主要是工程代码上的能力的提升，由于数据量比较大，必须对代码进行优化才能跑起来。

<img src="https://s2.loli.net/2022/02/21/s12ZbwQOqtFlWCx.png" alt="image-20220221185752588" style="zoom: 50%;" />

## 赛题介绍

任务：本次比赛基于脱敏和采样后的数据信息，对于给定的一定数量到访过微信视频号“热门推荐”的用户，根据这些用户在视频号内的历史n天的行为数据，通过算法在测试集上预测出这些用户对于不同视频内容的互动行为（包括点赞、点击头像、收藏、转发等）的发生概率。

指标：加权uauc (有效用户的auc)

数据：初赛百万级、复赛千万级。给定视频相关信息，用户对于视频的标签，详细介绍见[附件：赛题描述——微信视频号推荐算法](https://algo.weixin.qq.com/problem-description)

## 初赛总结

- 初赛只预测4个行为，百万级（700w），深度学习效果不如机器学习树模型，为了苟进复赛主要探索方向是在提取特征，再输入机器学习模型。
- 主要的特征：
  - 历史滑窗统计特征（对各字段以及多字段组合进行详细的统计特征提取）
  - 文本类特征（TDIDF + SVD），w2v 训练
  - ctr类特征（userid、feedid、authorid、tag、keyword等转化率）
  - Embedding类特征（历史feedid序列的feedembedding进行mean pool）
  - 交互特征：使用所有的历史数据，构建userid-feedid,userid-authorid，userid-tag,user-keyword矩阵，使用SVD，得到交互特征
  - 图特征（队友的工作）
- 模型：lightgbm 

## 复赛总结

- 复赛数据量扩大到10倍，深度学习的优势体现出来，复赛的主要收获：
  - 第一次使用tensorflow
  - 千万级数据的训练，在Dataloader生成训练Batch的时候进行特征的提取以及merge,相当GPU一边训练，CPU一边处理数据。一般习惯先把所有特征提好了放内存里再进行训练，这里的千万级数据就行不通。
  - 官方给的代码规范很受用，
- 复赛的前半段主要是致力于初赛特征方案的复现，并放入深度学习模型中进行训练，由于数据量太大，以及平台的资源不足，经常优化后跑半天报错了。该工作耗费复赛一半的赛程。
- 复赛主要使用了多任务模型，7个单任务太慢了，初赛模型方案放弃
- 复赛后半段主要探索MMOE\PLE多任务模型
- 最后2天只使用几个id,训练了一个简单的sharebottom结构，超过了之前所有的尝试
- 通过Batch里merge特征，成功用上了初赛的特征

